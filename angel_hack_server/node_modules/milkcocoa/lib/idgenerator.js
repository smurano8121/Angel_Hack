function n2s(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=e%62,r=Math.floor(e/62);return 1>r?"":n2s(r)+t[n]}function IdGenerator(){function e(n){return 1>=n?t[Math.floor(36*Math.random())]:t[Math.floor(36*Math.random())]+e(n-1)}var t="ybfghijam6cpqdrw71nx34eo5suz0t9vkl28",n=(new Date).getTime(),r=n,o=null,i=[],a=0,g=1,s=a,u="0000";return{init:function(e){if(e&&"number"==typeof e){n=(new Date).getTime(),r=Math.floor(e/1e3);var t=n2s(r);u=t.substr(t.length-4)}},getHeader:function(e,t){var r=this,i=(new Date).getTime();if(o==i)setTimeout(function(){r.getHeader(e,t)},1);else{o=i;var a=i-n;t((e+a).toString(36))}},getNextId:function(e){i.push(e),s==a&&this._exec_getNextId()},_exec_getNextId:function(){var e=this,t=i.shift();t?(s=g,this._getNextId(function(n,r){t(n,r),e._exec_getNextId()})):s=a},_getNextId:function(t){this.getHeader(r,function(n){var r=n+u+e(3);15!=r.length&&(global.console&&console.error("generated id is wrong.",r.length),r=r.substr(0,15)),t(null,r)})},getIdFromTs:function(t){var n=t.toString(36),r=n+u+e(3);return 15!=r.length&&(global.console&&console.error("generated id is wrong.",r.length),r=r.substr(0,15)),r}}}module.exports=IdGenerator;